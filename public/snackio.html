<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no" />
<title>Snake.io — Smooth + Rank + Buah + Custom Color + Saldo + Profil</title>

<!-- CSS utama -->
<link rel="stylesheet" href="./css/snackio.css">
</head>
<body>
<div id="wrap">
  <header>
    <div style="display:flex;gap:8px;align-items:center;">
      <span id="usernamePill" class="pill">
        <span class="nickname" id="usernameSpan"
          style="color:#fff;border:1px solid #000;background:transparent;">USER</span>
      </span>
      <span class="pill stat">Panjang: <span id="len">3</span></span>
      <span class="pill">User: <span id="userCount">0</span></span>
    </div>
    <div style="display:flex;gap:8px;align-items:center;">
      <span class="pill stat">Saldo: <span id="saldo">...</span></span>
      <button id="reset" class="btn" title="Mulai Ulang (R)">Reset</button>
    </div>
  </header>

  <!-- Panel Rank -->
  <div id="rankPanel">
    <h3>RANK</h3>
    <div id="rankRows"></div>
  </div>

  <!-- Game canvas -->
  <canvas id="game"></canvas>
  <div class="overlay"></div>

  <!-- Joystick -->
  <div class="joy" id="joy"><div class="knob" id="knob"></div></div>

  <!-- Tombol boost -->
  <footer><button id="boostBtn" class="btn">BOOST</button></footer>
</div>

<!-- ===== START MENU / CONFIG ===== -->
<div id="configPanel" class="modal" aria-modal="true" role="dialog">
  <div class="card">
    <h1>Pengaturan Awal</h1>
    <div class="money">
      <div class="chip">Saldo: <span id="saldoInModal">...</span></div>
      <div class="chip">Harga: Warna Rp10.000 | Panjang Rp5.000</div>
    </div>
    <div class="sub">
      Klik kotak untuk pilih warna (maks 5). Jika pilih banyak, ular akan <b>belang</b>
      dari <b>kepala (warna 1) → ekor</b>.
    </div>

    <div class="palette" id="palette">
      <div class="colorBox" data-i="0" style="background:#ffffff">Warna 1</div>
      <div class="colorBox" data-i="1" style="background:#ffffff">Warna 2</div>
      <div class="colorBox" data-i="2" style="background:#ffffff">Warna 3</div>
      <div class="colorBox" data-i="3" style="background:#ffffff">Warna 4</div>
      <div class="colorBox" data-i="4" style="background:#ffffff">Warna 5</div>
    </div>

    <div class="row">
      <div class="input">
        <span>Panjang awal</span>
        <input id="startLenInput" type="number" min="1" max="300" step="1" value="3" />
      </div>
      <button id="startBtn" class="btn" disabled>Mulai</button>
    </div>

    <div class="cost" id="costBox">
      <div class="row"><span>Biaya warna</span><strong id="costColor">Rp 0</strong></div>
      <div class="row"><span>Biaya panjang</span><strong id="costLen">Rp 0</strong></div>
      <div class="row total"><span>Total</span><span id="costTotal">Rp 0</span></div>
    </div>

    <div class="hint">Start aktif jika minimal satu warna dipilih & saldo cukup.</div>
  </div>
</div>

<!-- ===== CUSTOM COLOR PICKER MODAL ===== -->
<div id="colorModal" class="modal" style="display:none">
  <div class="card">
    <h1>Pilih Warna</h1>
    <div class="pickerGrid">
      <div class="preview" id="prevBox"></div>
      <div class="sl">
        <label>Hue <input id="hue" type="range" min="0" max="360" value="160"></label>
        <label>Saturation <input id="sat" type="range" min="0" max="100" value="85"></label>
        <label>Lightness <input id="lit" type="range" min="0" max="100" value="55"></label>
        <div class="hexRow">
          <span>#</span><input id="hex" type="text" value="58ff9b" maxlength="6">
        </div>
        <div class="swatches" id="swatches"></div>
      </div>
    </div>
    <div class="actions">
      <button id="cancelPick" class="btn">Batal</button>
      <button id="okPick" class="btn">Pilih</button>
    </div>
  </div>
</div>

<div class="toast" id="toast" style="display:none"></div>

<!-- ===== URUTAN SCRIPT ===== -->
<script type="module" src="./js/firebase-boot.js"></script>
<script type="module" src="./js/helpers.js"></script>
<script type="module" src="./js/picker.js"></script>
<script type="module" src="./js/saldo.js"></script>
<script type="module" src="./js/game-core.js"></script>
<script type="module" src="./js/mp-firestore.js"></script>
<script type="module" src="./js/controller.js"></script>
</body>
  </html>
